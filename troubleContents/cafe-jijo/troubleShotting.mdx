---
title: Jijo Cafe í”„ë¡œì íŠ¸ íŠ¸ëŸ¬ë¸” ìŠˆíŒ…
category: cafe-jijo
---

# ðŸŠâ€â™‚ï¸ íŠ¸ëŸ¬ë¸” ìŠˆíŒ…

## 1. zustandë¥¼ í†µí•œ ë¡œê·¸ì¸/íšŒì›ê°€ìž… ìƒíƒœ êµ¬í˜„

### ë¬¸ì œì 

- íšŒì›ê°€ìž…ì´ë‚˜, ë¡œê·¸ì¸, ë¡œê·¸ì•„ì›ƒì€ PB SDKë¥¼ ì‚¬ìš©í•˜ì—¬ `useAuthStore`ì˜ ë©”ì„œë“œë¡œ êµ¬ì„±ì„ í–ˆì—ˆë‹¤
- ì—¬ê¸°ì„œ ìƒê°í•˜ê¸°ì— ìƒˆë¡œ ì—…ë°ì´íŠ¸ ë˜ê±°ë‚˜ / í˜¹ì€ ë°ì´í„° ë‚´ì— ìžˆë˜ ê¸°ì¡´ ìœ ì €ì •ë³´ë¥¼ `store`ë‚´ ì—…ë°ì´íŠ¸ ëœ `initalAuthState`ì— ë‹´ì•„ì•¼í•˜ëŠ”ë° ê·¸ ë°©ë²•ì„ ì–´ë–»ê²Œ êµ¬í˜„í•´ì•¼ê¹Œ?

**í˜„ìž¬ê¹Œì§€ êµ¬ì„±í•œ ì½”ë“œ**

```jsx
import pb from "@/api/pocketbase";
import {create} from "zustand";

const initalAuthState = {
  isAuth: false,
  user: null,
  token: "",
};

const useAuthStore = create((set) => ({
  ...initalAuthState,

  /* Pb SDKë¥¼ ì‚¬ìš©í•œ íšŒì›ê°€ìž… */
  signUp: async (registerUser) => {
    return await pb.collection("users").create(registerUser);
  },

  /* Pb SDKë¥¼ ì‚¬ìš©í•œ ë¡œê·¸ì¸ */
  signIn: async (userNameOrEmail, password) => {
    return await pb
      .collection("users")
      .authWithPassword(userNameOrEmail, password);
    // dbì— ìžˆëŠ” ìœ íš¨í•œ ë¡œê·¸ì¸ ì •ë³´ì¼ì‹œ í•´ë‹¹ ì •ë³´ë¥¼ setì„ í†µí•´ ë‹´ì•„ì•¼ í•  ê²ƒê°™ì€ë° ì–´ë–»ê²Œ ë‹´ì•„ì•¼í• ì§€ ëª¨ë¥´ê² ìŠµë‹ˆë‹¤ðŸ¥¹
  },

  /* Pb SDKë¥¼ ì‚¬ìš©í•œ ë¡œê·¸ì•„ì›ƒ */
  signOut: async () => {
    return await pb.authStore.clear();
  },

  /* Pb SDKë¥¼ ì‚¬ìš©í•œ íšŒì›íƒˆí‡´ */
  Withdrawal: async (recordId) => {
    return await pb.collection("users").delete(recordId);
  },
}));

export default useAuthStore;
```

### í•´ê²° : ì‘ë‹µë°›ì€ ê²°ê³¼ë¥¼ ë°”ë¡œ ë‚´ë³´ë‚´ì§€ ì•Šê³ , Zustandì˜ set() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ì•± ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ìž!

**store/auth.js**

```tsx
import pb from "@/api/pocketbase";
import {create} from "zustand";
import {devtools} from "zustand/middleware";

const USER_COLLECTION = "users";

const initialAuthState = {
  isAuth: false,
  user: null,
  token: "",
};

const authStore = (set) => ({
  ...initialAuthState,

  /* Pb SDKë¥¼ ì‚¬ìš©í•œ íšŒì›ê°€ìž… */
  signUp: async (registerUser) => {
    return await pb.collection(USER_COLLECTION).create(registerUser);
  },

  /* Pb SDKë¥¼ ì‚¬ìš©í•œ ë¡œê·¸ì¸ */
  signIn: async (userNameOrEmail, password) => {
    const authData = await pb
      .collection(USER_COLLECTION)
      .authWithPassword(userNameOrEmail, password);

    const {isValid, model, token} = pb.authStore;

    set(
      (state) => ({
        ...state,
        isAuth: isValid,
        user: model,
        token,
      }),
      false,
      "auth/singin"
    );

    return authData;
  },

  /* Pb SDKë¥¼ ì‚¬ìš©í•œ ë¡œê·¸ì•„ì›ƒ */
  signOut: async () => {
    const response = await pb.authStore.clear();

    set(
      (state) => ({
        ...state,
        ...initialAuthState,
      }),
      false,
      "auth/singout"
    );

    return response;
  },

  /* Pb SDKë¥¼ ì‚¬ìš©í•œ íšŒì›íƒˆí‡´ */
  withDrawal: async (recordId) => {
    const response = await pb.collection(USER_COLLECTION).delete(recordId);

    set(
      (state) => ({
        ...state,
        ...initialAuthState,
      }),
      false,
      "auth/withDrawal"
    );

    return response;
  },
});

const useAuthStore = create(devtools(authStore));

export default useAuthStore;
```

ë¡œê·¸ì¸ íŽ˜ì´ì§€ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‚¬ìš©ì€??

```tsx
import useAuthStore from '@/store/auth';
// ...

function SignIn() {
  const isAuth = useAuthStore((state) => state.isAuth);
  const signIn = useAuthStore((state) => state.signIn);

  const [formState, setFormState] = useState({
    email: '',
    password: '',
  });

  const handleSignIn = async (e) => {
    e.preventDefault();

    const { email, password } = formState;

    try {
      await signIn(email, password);
			// ...
    } catch (error) {
      console.error(error);
    }
  };

	// ...

  return (...);
}
```
